<div class="bg">
  <app-partida-navbar
    (tiempoPreguntasSeg)="(this.tiempoPreguntasSeg)"></app-partida-navbar>

  <div *esHost="{idPartida,renderContentUser: true};sino esUsuario">
    <div
      class="container d-flex justify-content-center"
      *ngIf="!finDePartida">
      <div class="d-flex align-items-center">
        <button
          *ngIf="inicioPartida"
          class="btn btn_iniciar_partida mt-5 mb-5"
          [disabled]="!habilitarBtnPregunta"
          style="font-size: 2rem"
          (click)="mostrarSiguientePreg()">
          Mostrar siguiente pregunta
        </button>
      </div>
    </div>
    <ng-container *ngIf="this.resultados$ | async as resultados">
      <div
        *ngIf="resultados.length > 0 && !finDePartida; else mostrarPregunta"
        class="row d-flex justify-content-center">
        <app-comprobacion-opciones
          *ocultarDespuesDe="10000; mostrar: templateDespuesDelay"
          [opcionesSeleccionadas]="opcionesSeleccionadas"
          [opcionesCorrectas]="opcionesCorrectas"
          [tipoDePregunta]="
            preguntaActual.tipoDePregunta
          "></app-comprobacion-opciones>
        <ng-template #templateDespuesDelay
          ><app-ranking [partidaResultadosPrevios]="resultados"></app-ranking
        ></ng-template>
      </div>
      <ng-template #mostrarPregunta>
        <div *ngIf="finDePartida">
          <app-comprobacion-opciones
            *ocultarDespuesDe="10000; mostrar: templateDespuesDelay"
            [opcionesSeleccionadas]="opcionesSeleccionadas"
            [opcionesCorrectas]="opcionesCorrectas"
            [tipoDePregunta]="
              preguntaActual.tipoDePregunta
            "></app-comprobacion-opciones>
          <ng-template #templateDespuesDelay>
            <app-podio
              [partidaResultadosFinales]="partidaResultadosFinales"></app-podio>
          </ng-template>
        </div>
        <div
          [@onLoadAnimation]
          *ngIf="!finDePartida"
          class="container">
          <div class="bg row d-flex justify-content-center">
            <app-pregunta [pregunta]="preguntaActual"></app-pregunta>
            <!-- <div class="container">
              <div class="d-flex justify-content-center">
                <div class="col-md-8 p-5 card">
                  <div class="card-body text-center">
                    <h3>{{ preguntaActual.tipoDePregunta }}</h3>
                  </div>
                </div>
              </div>
            </div> -->
          </div>
        </div>
      </ng-template>
      <!-- <div *ngIf="finDePartida">
        <app-podio [partidaResultadosFinales]="resultados"></app-podio>
      </div> -->
    </ng-container>
  </div>

  <ng-template #esUsuario>
    <ng-container *ngIf="this.resultados$ | async as resultados">
      <div
        style="visibility: hidden"
        class="container d-flex justify-content-center"
        *ngIf="!finDePartida">
        <div class="d-flex align-items-center">
          <button
            *ngIf="inicioPartida"
            class="btn btn_iniciar_partida mt-5 mb-5"
            [disabled]="!habilitarBtnPregunta"
            style="font-size: 2rem"
            (click)="mostrarSiguientePreg()">
            Mostrar siguiente pregunta
          </button>
        </div>
      </div>
      <div
        *ngIf="resultados.length > 0 && !finDePartida; else mostrarPregunta"
        class="row d-flex justify-content-center">
        <app-comprobacion-opciones
          *ocultarDespuesDe="10000; mostrar: templateDespuesDelay"
          [opcionesSeleccionadas]="opcionesSeleccionadas"
          [opcionesCorrectas]="opcionesCorrectas"
          [tipoDePregunta]="
            preguntaActual.tipoDePregunta
          "></app-comprobacion-opciones>
        <ng-template #templateDespuesDelay>
          <app-ranking [partidaResultadosPrevios]="resultados"></app-ranking>
        </ng-template>
      </div>
      <ng-template #mostrarPregunta>
        <div *ngIf="finDePartida; else pregunta">
          <app-comprobacion-opciones
            *ocultarDespuesDe="10000; mostrar: templateDespuesDelay"
            [opcionesSeleccionadas]="opcionesSeleccionadas"
            [opcionesCorrectas]="opcionesCorrectas"
            [tipoDePregunta]="
              preguntaActual.tipoDePregunta
            "></app-comprobacion-opciones>
          <ng-template #templateDespuesDelay>
            <app-podio
              [partidaResultadosFinales]="partidaResultadosFinales"></app-podio>
          </ng-template>
        </div>
        <ng-template #pregunta>
          <div
            class="bg row d-flex justify-content-center"
            [@onLoadAnimation]>
            <div class="container">
              <app-pregunta [pregunta]="preguntaActual"></app-pregunta>
              <app-opciones
                [pregunta]="preguntaActual"
                (opcSeleccionadasEmit)="
                  obtenerOpcSelectDeChild($event)
                "></app-opciones>
              <!--  -->
              <div class="d-flex justify-content-center mt-4">
                <div class="d-flex align-items-center">
                  <button
                    class="btn btn_iniciar_partida mt-4 p-3"
                    (click)="responder()"
                    style="font-size: 2rem"
                    [disabled]="!opcionesSeleccionadas || yaRespondiste">
                    Responder
                  </button>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </ng-template>
    </ng-container>
  </ng-template>
</div>

<!--
  <ng-template #esUsuario>
  <div
    class="bg row d-flex justify-content-center"
    [@onLoadAnimation]>

    <div *ngIf="habilitarBtnPregunta && inicioPartida && !finDePartida">
      <app-ranking
        [partidaResultadosPrevios]="partidaResultadosPrevios"></app-ranking>
    </div>
    <div *ngIf="!habilitarBtnPregunta && !finDePartida">
      <app-pregunta
        *ngIf="tengoTriviaYOpciones"
        [pregunta]="preguntaActual._leyenda"></app-pregunta>
      <app-opciones
        *ngIf="tengoTriviaYOpciones"
        [pregunta]="preguntaActual"></app-opciones>
    </div>
  </div>
</ng-template>
 -->
